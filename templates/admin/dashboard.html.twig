
{% extends 'base.html.twig' %}
{% block title %}Tableau de bord admin{% endblock %}

{% block body %}
<section id="admin-dashboard" class=" mt-6 mb-6 max-w-7xl mx-auto flex min-h-0 lg:h-[calc(100vh-49px)]">
    {% include 'profile/partials/_profile_aside.html.twig' %}

    <section id="dashboard-container" class="ml-5 rounded-xl border border-gray-200 w-full p-8 overflow-y-auto scrollbar-hide bg-gray-50">

        <h1 class="text-2xl font-semibold text-violet-800 mb-8">Tableau de bord</h1>

  
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
    
            <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm flex flex-col justify-between hover:shadow-md transition">
                <div class="flex justify-between items-center">
                    <p class="text-sm text-gray-500">Total utilisateurs</p>
                    <i class="fa-regular fa-user text-violet-600 text-xl"></i>
                </div>
                <p class="text-3xl font-bold text-violet-700 mt-2">{{ stats.totalUsers }}</p>
            </div>

      
            <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm flex flex-col justify-between hover:shadow-md transition">
                <div class="flex justify-between items-center">
                    <p class="text-sm text-gray-500">Inscriptions cette semaine</p>
                    <i class="fa-solid fa-user-plus text-violet-600 text-xl"></i>
                </div>
                <div class="flex items-center justify-between mt-2">
                    <p class="text-3xl font-bold text-violet-700">{{ stats.usersThisWeek }}</p>
                    <p class="text-sm {{ stats.userGrowth >= 0 ? 'text-green-600' : 'text-red-600' }}">
                        {% if stats.userGrowth >= 0 %}
                            <i class="fa-solid fa-arrow-up"></i>
                        {% else %}
                            <i class="fa-solid fa-arrow-down"></i>
                        {% endif %}
                        {{ stats.userGrowth }}%
                    </p>
                </div>
            </div>

            <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm flex flex-col justify-between hover:shadow-md transition">
                <div class="flex justify-between items-center">
                    <p class="text-sm text-gray-500">Total itinéraires</p>
                    <i class="fa-regular fa-map text-violet-600 text-xl"></i>
                </div>
                <p class="text-3xl font-bold text-violet-700 mt-2">{{ stats.totalItineraries }}</p>
            </div>

          
            <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm flex flex-col justify-between hover:shadow-md transition">
                <div class="flex justify-between items-center">
                    <p class="text-sm text-gray-500">Itinéraires cette semaine</p>
                    <i class="fa-solid fa-route text-violet-600 text-xl"></i>
                </div>
                <div class="flex items-center justify-between mt-2">
                    <p class="text-3xl font-bold text-violet-700">{{ stats.itinerariesThisWeek }}</p>
                    <p class="text-sm {{ stats.itineraryGrowth >= 0 ? 'text-green-600' : 'text-red-600' }}">
                        {% if stats.itineraryGrowth >= 0 %}
                            <i class="fa-solid fa-arrow-up"></i>
                        {% else %}
                            <i class="fa-solid fa-arrow-down"></i>
                        {% endif %}
                        {{ stats.itineraryGrowth }}%
                    </p>
                </div>
            </div>
        </div>

     
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-10">
         
            <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm flex flex-col justify-between hover:shadow-md transition">
                <div class="flex justify-between items-center">
                    <p class="text-sm text-gray-500">Total lieux</p>
                    <i class="fa-solid fa-location-dot text-violet-600 text-xl"></i>
                </div>
                <p class="text-3xl font-bold text-violet-700 mt-2">{{ stats.totalLocations }}</p>
            </div>

   
            <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm flex flex-col justify-between hover:shadow-md transition">
                <div class="flex justify-between items-center">
                    <p class="text-sm text-gray-500">Lieux cette semaine</p>
                    <i class="fa-regular fa-map text-violet-600 text-xl"></i>
                </div>
                <div class="flex items-center justify-between mt-2">
                    <p class="text-3xl font-bold text-violet-700">{{ stats.locationsThisWeek }}</p>
                    <p class="text-sm {{ stats.locationsGrowth >= 0 ? 'text-green-600' : 'text-red-600' }}">
                        {% if stats.locationsGrowth >= 0 %}
                            <i class="fa-solid fa-arrow-up"></i>
                        {% else %}
                            <i class="fa-solid fa-arrow-down"></i>
                        {% endif %}
                        {{ stats.locationsGrowth }}%
                    </p>
                </div>
            </div>

            <div class="bg-transparent lg:block hidden"></div>
            <div class="bg-transparent lg:block hidden"></div>
        </div>

        <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-5">
            <h2 class="text-xl font-semibold text-violet-800 mb-4">Derniers lieux ajoutés</h2>

            {% if latestLocations is empty %}
                <p class="text-gray-500 italic">Aucun lieu ajouté récemment.</p>
            {% else %}
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="border-b border-gray-200 bg-gray-50">
                                <th class="text-left text-sm font-semibold text-gray-600 px-4 py-3">Nom</th>
                                <th class="text-left text-sm font-semibold text-gray-600 px-4 py-3">Ville</th>
                                <th class="text-left text-sm font-semibold text-gray-600 px-4 py-3">Date d’ajout</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for loc in latestLocations %}
                                <tr class="border-b border-gray-100 hover:bg-violet-50 transition">
                                    <td class="px-4 py-3 text-violet-700 font-medium">{{ loc.locationName }}</td>
                                    <td class="px-4 py-3 text-gray-600">{{ loc.city ?? 'Non spécifiée' }}</td>
                                    <td class="px-4 py-3 text-sm text-gray-500">
                                        {{ loc.createdAt ? (loc.createdAt|date('d/m/Y')) : '–' }}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% endif %}
        </div>
    </section>
</section>
{% endblock %}
